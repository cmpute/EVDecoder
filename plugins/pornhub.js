ExView.Plugins({info:{name:"PornHub视频",version:"2.2",author:"Gentle",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABuVBMVEUAAAATExQpKSoSERK6ubkjIyOGXyL/nAv/qQn/nQPIycowLy8tLS6KXSQqIRj/oxH/sAr/ngpIKwhCJwgAAgj/rAfc3NzU1dXLy8y+vr5wcHFra2xTVltTU1c+Pz8zMzSQXyQdHyJmRyHQhCCOWyAxJx4UFh4nIhwsIBs4Jxk8LxgYGBjiixZLLBZGKRXpkRKwbxKlZBEODw/Wig6+cw6sbQ4NDQ3/oQzSfQxkOQxEKwxBIgvcjgk3HggpFwczGQYDBAQ8HwE3GwAfDwDl5eTPztDExcXExMS8u7u6urq0tLSur6+mpaWcnJyZmZmQkJGGi5GIiYqJiIiHhoZ4eHhfY2pbX2FMTE5JSUtDQ0NtUCmPWSjdkxxXNxwmHhzXjBuWXxtOOxs+KxuxdBogGhrAeRluQBn/sxixaxhrPxfajRbZjBbJhRYNDha/fBVZQxVPNxVRNRU9IhVCKRTgiBPBhBPgixKgZhKcYxJMJhKgXBF/SxCcaQ9JMQ9NLQ/vlg72lA7Cfg51SA6ARw5qRQ6RUA39nQxjQAymYQv/tQrwlQqLWQpXNgo6Iwnpjwj/pgf/rQT/pAT/oAB5tk+9AAABCUlEQVQY0w3CA5bDABQAwB8ndZuktm0ba9u2bds+8XbegEnXpyV8GOJDMKReBERDP94JKAJRAkui0SSgKmM3PtDaYtTgBnWHBgVU2dY1qgIt3mwRqcuCERAqESgLdO29TZhJAI3DQAxxAJaeQU7PbRpALwRnTaHIVkpVtqpgK1c1J0zZ6BRFUXI5JZU+yScc4Pbfp3nmj2HoxwTNhBwgOcpZL0K3+a+Nj92TtTcPSPzsZXYpcBw/3S6tfsa8IFnPLYaDgfBWcPJ9ubjiBfd0IR7Z33l+2JstzBRtc+A6OIulXw4z55HEXWb+xgML+dcUzUtlsu9fGf9z7QKR1SweJ8V2MUmSdvOY8B/31TPuxuWpowAAAABJRU5ErkJggg==",
db:"pornhub",apihost:"https://www.pornhub.com/",pagetitle:["<br>","收藏","首页","类型","下载"],download:!1,lazyload:!0,setting:!0,type:"video",theme:"orange",cdn:""},set:function(a){},unset:function(a){},init:function(a){ExView.workers.fav.listloader({callback:function(){}})},flags:{indexflag:{loader:function(a){var b="",c=$$(".type-chooser a.active").attr("data-value");c&&(b=c+"&");return{url:pluginfo(a.plugin).apihost+"video?"+b+"page="+(a.page||1),method:"GET",timeout:120,
ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){a.callback({img:pluginfo(a.plugin).icon,multpage:!0,result:b,header:c})}}},finder:function(a){return{query:!0,selector:"ul.videos.recommendedContainerLoseOne>li.videoBox,ul.videos.nf-videos>li.videoBox,ul.videos.search-video-thumbs>li.videoBox",str:a.result,successfn:function(b){array_count(b)?plugfns(a.plugin).pagedeal(b,a):a.callback()}}},
countloader:!1,countfinder:function(a){return{successfn:function(b){a.callback({pagecount:0})}}}},typeflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"categories",method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){a.callback({title:"首页",img:pluginfo(a.plugin).icon,group:{name:"daohang",
title:"导航"},content:"首页"});a.callback({tid:"",listflag:"recommended",title:"推荐",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"推荐"});a.callback({tid:"",listflag:"video?o=ht",title:"热门",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"热门"});a.callback({tid:"",listflag:"video?o=mv",title:"人气",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"人气"});
a.callback({tid:"",listflag:"video?o=tr",title:"排行",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"排行"});a.callback({tid:"",listflag:"video?o=cm",title:"最新",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"最新"});a.callback({tid:"s",listflag:"video/search?search=mmd",title:"MMD",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"MMD"});a.callback({tid:"c",listflag:"categories/hentai",
title:"Hentai",img:"https://bs.phncdn.com/images/categories/118x88/36.jpg?cache=1488300184",group:{name:"fenlei",title:"分类"},content:"Hentai"});$$("#type-page").find(".type-chooser").remove();$$("#type-page").prepend('<div class="toolbar tabbar type-chooser" style="top: 0!important;"><style>.type-chooser a.active{border-bottom: 3px solid white;}</style><div class="toolbar-inner"><a href="javascript:void(0);" class="tab-link active" data-value="">最近</a><a href="javascript:void(0);" class="tab-link"  data-value="o=mv">热度</a><a href="javascript:void(0);" class="tab-link" data-value="o=tr">排行</a><a href="javascript:void(0);" class="tab-link" data-value="o=ht">最热</a><a href="javascript:void(0);" class="tab-link" data-value="o=lg">最长</a><a href="javascript:void(0);" class="tab-link" data-value="o=cm">最新</a></div></div>');
$$(".type-chooser a").on("click",function(){$$(".type-chooser a.active").removeClass("active");$$(this).addClass("active")});return{query:!0,selector:".categories-list>li",str:a.result,successfn:function(b){array_count(b)&&$$(b).each(function(){var b=$$(this);a.callback({tid:"c",listflag:b.find(".js-mxp").attr("href"),title:b.find(".js-mxp").attr("alt"),img:b.find("img").attr("src"),group:{name:"fenlei",title:"分类"},content:b.find(".js-mxp").attr("alt")+"<br>"+b.find("span").text()+"&nbsp;"})})}}}},
listflag:{loader:function(a){var b="";if("c"==a.tid){var c=$$(".type-chooser a.active").attr("data-value");c&&(b=(-1==a.flag.indexOf("?")?"?":"&")+c)}if("s"==a.tid){c=$$(".type-chooser a.active").attr("data-value");switch(c){case "o=cm":c="o=mr";break;case "o=ht":c=""}c&&(b=(-1==a.flag.indexOf("?")?"?":"&")+c)}return{url:pluginfo(a.plugin).apihost+a.flag+b+(-1!=a.flag.indexOf("?")||b?"&":"?")+"page="+(a.page||1),method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",
cookie:"platform=pc",successfn:function(b,c){a.callback({multpage:!0,result:b,header:c})}}},finder:function(a){return{query:!0,selector:"ul.videos.recommendedContainerLoseOne>li.videoBox,ul.videos.nf-videos>li.videoBox,ul.videos.search-video-thumbs>li.videoBox",str:a.result,successfn:function(b){array_count(b)?plugfns(a.plugin).pagedeal(b,a):a.callback()}}},countloader:!1,countfinder:function(a){return{successfn:function(b){a.callback({pagecount:0})}}}},searchflag:{loader:function(a){var b="",c=$$(".type-chooser a.active").attr("data-value");
switch(c){case "o=cm":c="o=mr";break;case "o=ht":c=""}c&&(b="&"+c);return{url:pluginfo(a.plugin).apihost+"video/search?search="+encodeURIComponent(a.keyword).toLowerCase()+"&page="+(a.page||1)+b,method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){a.callback({multpage:!0,result:b,header:c})}}},finder:function(a){return{query:!0,selector:"ul.search-video-thumbs>li.videoBox",
str:a.result,successfn:function(b){array_count(b)?plugfns(a.plugin).pagedeal(b,a):a.callback()}}},countloader:!1,countfinder:function(a){return{successfn:function(b){a.callback({pagecount:0})}}}},contentflag:{loader:function(a){return{successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){return{successfn:function(b,c,d,e){if(array_count(b)){if(a.checkupdate)return a.callback({pid:a.pid,cid:"1",title:"全一话"}),!0;e=[];d=0;e[d]=a.callback({id:d,newest:a.newest&&
0==d,pid:a.pid,cid:"1",title:"全一话",count:1,reverse:0});return e}a.callback()}}},infoloader:!1,infofinder:function(a){return{successfn:function(b,c,d,e){a.callback({added:a.data,comment:1,preview:1,sourceurl:pluginfo(a.plugin).apihost+"view_video.php?viewkey="+a.pid});return!0}}}},parseflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"view_video.php?viewkey="+a.pid,method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",
cookie:"platform=pc",successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){return{reg:/var\s*flashvars\_(\d+)\s*=\s*(.*?);\r*\n/g,find:"$2",str:a.result,successfn:function(b,c,d,e){var f=JSON.parse(b);console.log(f);var g=[];f.mediaDefinitions.forEach(function(a){a.videoUrl&&g.push(a)});array_count(g)&&!a.download?(ExView.fw.hidePreloader(),b='<div class="list-block" style="margin:0"><div>时长: '+f.video_duration+'s</div><ul class="videosourcecheck"><li><label class="label-radio item-content"><input type="radio" name="my-radio" value="ext" checked="checked"><div class="item-media"><i class="icon icon-form-radio"></i></div><div class="item-inner"><div class="item-title">外部播放器打开</div></div></label></li>'+
g.map(function(a,b){return'<li><label class="label-radio item-content"><input type="radio" name="my-radio" value="'+b+'"><div class="item-media"><i class="icon icon-form-radio"></i></div><div class="item-inner"><div class="item-title">'+gettext(a.quality)+"p</div></div></label></li>"}).join("")+"</ul></div>",ExView.fw.confirm(b,myContent.name,function(){$$(".videosourcecheck input").each(function(b){if($$(this).prop("checked"))if(ExView.fw.hidePreloader(),"ext"==$$(this).val()){var c=g[0].videoUrl;
fileopener(c,"*/*")}else{c=g[b-1].videoUrl;--b;var d=[];g.forEach(function(a,b){d.push({name:a.quality+"P",url:a.videoUrl})});a.callback({poster:f.image_url,url:f.link_url,source:c,type:"video",videoType:"mp4",quality:d,defaultQuality:b,title:myContent.name+getnavundertitle(a.title),danmaku:{id:"Pornhub_"+a.pid,api:"https://api.prprpr.me/dplayer/",token:"tokendemo",maximum:1E3,user:"ExView"}})}})})):a.callback();return!0}}}},commentflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"view_video.php?viewkey="+
a.pid,method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){b?a.callback({result:b,header:c,commentbrowser:{url:pluginfo(a.plugin).apihost+"view_video.php?viewkey="+a.pid,title:"评论 - "+(myContent.name||""),browser:!0,flag:""}}):a.callback()}}},finder:function(a){return{query:!0,selector:".commentBlock:not([data-parent-id='[[id]]'])",str:a.result,successfn:function(b,
c,d,e){if(array_count(b))for(b=$$(b),d=0;d<b.length;d++)a.callback({page:a.page||1,pagecount:1,comment:{text:b.eq(d).find(".commentMessage>span").text(),name:b.eq(d).find(".usernameLink").text(),avatar:"'"+b.eq(d).find("img.avatarTrigger").attr("src")+"'",type:"received",label:b.eq(d).find(".date.floatRight").text(),day:"",time:"",reverse:1,extra:""}})}}},send:!1},previewflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"view_video.php?viewkey="+a.pid,method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",
cookie:"platform=pc",successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){console.log(a);return{reg:/var\s*flashvars\_(\d+)\s*=\s*(.*?);\r*\n/g,find:"$2",str:a.result,successfn:function(b,c,d,e){b=JSON.parse(b);console.log(b);c=[];e=parseInt(getstr(/\{(\d+)\}/,b.thumbs.urlPattern));for(d=0;d<e;d++)c.push(b.thumbs.urlPattern.replace("{"+e+"}",d+1));for(d=0;d<c.length;d++)a.callback({page:a.page||1,pagecount:1,preview:{imgurl:c[d],pageurl:c[d]}})}}}},pageimgflag:{parser:function(a){return{successfn:function(b){a.callback({imgurl:a.pageurl})}}}},
updateflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"recommended?page="+(a.page||1),method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){return{query:!0,selector:"ul.videos.recommendedContainerLoseOne>li.videoBox,ul.videos.nf-videos>li.videoBox,ul.videos.search-video-thumbs>li.videoBox",str:a.result,
successfn:function(b){array_count(b)?plugfns(a.plugin).pagedeal(b,a):a.callback()}}}},hotflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"video?o=ht&cc=us&page="+(a.page||1),method:"GET",timeout:120,ua:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36",cookie:"platform=pc",successfn:function(b,c){a.callback({result:b,header:c})}}},finder:function(a){return{query:!0,selector:"ul.videos.recommendedContainerLoseOne>li.videoBox,ul.videos.nf-videos>li.videoBox,ul.videos.search-video-thumbs>li.videoBox",
str:a.result,successfn:function(b){array_count(b)?plugfns(a.plugin).pagedeal(b,a):a.callback()}}}}},fns:{pagedeal:function(a,b){b=b||{};var c=$$(a),d=c.attr("_vkey"),e=c.find("img").attr("data-mediumthumb")||c.find("img").attr("data-image"),f=c.find(".title").text(),g="时长："+c.find(".duration").text(),h=c.find(".added").text(),c=c.find(".views").text();if(b.multupdate||b.multhot||b.multsearch)return b.callback(obj_contact(b,{pid:d,img:e,title:f,content:h})),!1;b.callback({pid:d,title:f,
img:e,stitle:g||"",content:getboxitem(h)+getboxitem(c),comment:1,preview:1})}}});
