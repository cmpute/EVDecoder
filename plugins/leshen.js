ExView.Plugins({info:{name:"乐神漫画",version:"2.2",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC20lEQVQ4jV2TX2iWdRTHP+f3e55tho54hwpiFKg4CcmRo5t835UXq5t2E0HeFNi6EPUqG1umYTLRICEibWFIFoUV9OeilUUrWwTpVoSkW2uY6YLx2tg7fZ/3+f05XbybMb9wOOfi+z3nwDlfuA0v9u1Y4f8+ctH/slX90Fp1g+s0/2KL5md3697tHS/fzpeFolgqse/p5Z923DP0mDAHmqI1i9YSYmbRKmhmoHkTnf2jq7+/8M/VWw2KpRJfv9o+IlcG2miwiERUDXgz30TQzKA1g1YVtQU6j19b/cOl61cFoHbhzW5GegekMUGsglFQQb2gTtBc0NygmaDVgHiIjc0s3TMmdu/zO9lSPXkeVVQFfECdoj5B8wDOot6gTiA2Ii0bsQ88w7WmdUxcz5ul9vOxUhh+aUiSiKxoxWzYhllVRJYsJ86M4b/agVbK4AStKemjr3BktsTBM5fJfESq73R9onGuKy32Yu5+CATi5BnU30SWriKWxwmDz6HekHa8QM+NLo7+OAXBgQ8kdnP3/XZ9JyKWWJnCnx/AbnwC27IBAD/8OupT7Mp7ef/ObRw9ewUSCzEAEYkxjgBtoTyO//UDGop7kKQJARTIB/sgm+FGcR+tH88xPVeD3EEtB+dIgMFQ/qMt/v4ZWuzjvcmbvDsxy59V4ZvOAnc90g9Az/A001mcv7ze+qAkVqb6ZfzL3s9XdtNzapKJDGhMwSTMOgXg7UsVXvttFkRBFeL8emjZZnmeH7vjyd0Hfppe8m8QkHo0WdhUSOgfmeHw6AzECD6A9/UcAzJ04j4BePz0WPLReMXRkEJqwVowpj5FqItDqAtzB84jzp3Tgw+2G4DRQ0/5NcvseryD3IPz4Fx92rwAF+rZByT4v/TUrvZFZiq0bka2H28o50xhbQFj/rfcwgYhIsEd0JM793N5dLEbF5Bu7SZ0PNsShf3Aw0ALUS8S4xt8+9aHfHdiEf8/kXp2QUped4oAAAAASUVORK5CYII=",
db:"leshen",apihost:"http://m.dangniao.com/",pagetitle:["<br>","收藏","首页","类型","下载"],lazyload:!0,download:!0,setting:!0,cdn:""},set:function(a){},unset:function(a){},init:function(){ExView.workers.fav.listloader({callback:function(){ExView.workers.index.loader()}})},flags:{indexflag:{loader:function(a){a.front||a.page||addtypelist('<div align="center" class="list-block"><img src="img/logo.png"/><br>类型<br>正在加载...<div class="progress"></span></div>',
2);return{url:pluginfo(a.plugin).apihost,method:"GET",timeout:120,successfn:function(b,c){ExView.workers.index.countfinder(obj_contact(a,{result:b,header:c}));a.front||a.page||ExView.workers.type.finder({result:b,plugin:a.plugin});a.successfn&&a.successfn({result:b,header:c})},errorfn:function(){a.page||(setnowlistname("首页","",pluginfo(a.plugin).icon),addtypelist('<div align="center" class="list-block"><a href="javascript:void(0);" onclick="ExView.workers.type.loader();"><img src="img/logo.png"/><br>加载失败，请刷新重试！</a></div>',
2));ExView.fw.alert("网络错误！","ExView")},canclefn:function(){a.page||(setnowlistname("首页","",pluginfo(a.plugin).icon),addtypelist('<div align="center" class="list-block"><a href="javascript:void(0);" onclick="ExView.workers.type.loader();"><img src="img/logo.png"/><br>加载失败，请刷新重试！</a></div>',2))},showinfo:{text:"正在加载..."+(1<a.page?"<br>第"+a.page+"页":""),name:"首页",title:a.title,
img:a.img}}},finder:function(a){return{reg:/\/mh\/([\w,\d]+)\/\"><img\s*data\-src\=\"((?!<).*?)\"\s*><h3>((?!<).*?)<\/h3><p>((?!<).*?)<\/p><\/a>/g,str:getresult(a.result),find:{pid:"$1",img:"$2",title:"$3",content:"$4"},successfn:function(a){console.log(JSON.stringify(a));array_count(a)?addcardlist({pid:a.pid,title:a.title,img:a.img,content:a.content,comment:1}):addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>没有内容</div>',2)},errorfn:function(){a.page||
setnowlistname("首页","",pluginfo(a.plugin).icon);ExView.fw.hidePreloader();mySession.isloading=0;ExView.fw.alert("网络错误！","ExView")}}},countloader:function(a){return!1},countfinder:function(a){return{successfn:function(){mySession.nowlistpages="-1|首页|index";mySession.nowlistpage=1;console.log(mySession.nowlistpages);return!0}}}},typeflag:{loader:!1,finder:function(a){addtypelist({title:"首页",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},
content:"首页"});addtypelist({tid:"",listflag:"new",title:"最新",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"最新"});addtypelist({tid:"",listflag:"hot",title:"热门",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"导航"},content:"热门"});addtypelist({tid:"0",title:"全部",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"全部"});addtypelist({tid:"9",title:"爱情",
img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"爱情"});addtypelist({tid:"15",title:"唯美",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"唯美"});addtypelist({tid:"16",title:"都市",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"都市"});addtypelist({tid:"3",title:"玄幻",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"玄幻"});
addtypelist({tid:"20",title:"校园",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"校园"});addtypelist({tid:"2",title:"武侠",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"武侠"});addtypelist({tid:"1",title:"热血",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"热血"});addtypelist({tid:"18",title:"穿越",img:pluginfo(a.plugin).icon,group:{name:"fenlei",
title:"分类"},content:"穿越"});addtypelist({tid:"7",title:"恐怖",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"恐怖"});addtypelist({tid:"5",title:"搞笑",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"搞笑"});addtypelist({tid:"22",title:"科幻",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"科幻"});addtypelist({tid:"19",title:"萌系",
img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"萌系"});addtypelist({tid:"17",title:"后宫",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"后宫"});addtypelist({tid:"6",title:"推理",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"推理"});addtypelist({tid:"10",title:"纯爱",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"纯爱"});
addtypelist({tid:"21",title:"魔幻",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"魔幻"});addtypelist({tid:"11",title:"生活",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"生活"});addtypelist({tid:"8",title:"耽美",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"耽美"});addtypelist({tid:"23",title:"动作",img:pluginfo(a.plugin).icon,group:{name:"fenlei",
title:"分类"},content:"动作"});addtypelist({tid:"24",title:"治愈",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"治愈"});addtypelist({tid:"25",title:"古风",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"古风"});addtypelist({tid:"26",title:"机甲",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"机甲"});addtypelist({tid:"27",title:"百合",
img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"百合"});addtypelist({tid:"28",title:"美食",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"美食"});addtypelist({tid:"33",title:"历史",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"历史"});addtypelist({tid:"29",title:"萝莉",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"萝莉"});
addtypelist({tid:"30",title:"修真",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"修真"});addtypelist({tid:"31",title:"斗智",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"斗智"});addtypelist({tid:"32",title:"科普",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"科普"});addtypelist({tid:"12",title:"战争",img:pluginfo(a.plugin).icon,group:{name:"fenlei",
title:"分类"},content:"战争"});addtypelist({tid:"4",title:"体育",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"体育"});addtypelist({tid:"13",title:"漫改",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"漫改"});addtypelist({tid:"14",title:"其他",img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"分类"},content:"其他"})}},listflag:{loader:function(a){var b=pluginfo(a.plugin).apihost+
"act/?act=list&page="+parseInt(a.page||1)+"&catid="+a.tid+"&ajax=1&order=1";switch(a.flag){case "new":b=pluginfo(a.plugin).apihost+"act/?act=list&page="+parseInt(a.page||1)+"&catid=0&ajax=1&order=1";break;case "hot":b=pluginfo(a.plugin).apihost+"act/?act=list&page="+parseInt(a.page||1)+"&catid=0&ajax=1&order=4"}return{url:b,method:"GET",timeout:120,successfn:function(b,e){b?(ExView.workers.list.countfinder(obj_contact(a,{result:b,header:e})),a.successfn&&a.successfn({result:b,header:e})):(ExView.fw.hidePreloader(),
mySession.isloading=0,ExView.fw.alert("【"+a.title+"】<br>获取失败！","ExView"))},showinfo:{text:"正在加载..."+(1<a.page?"<br>第"+a.page+"页":""),name:"【"+a.title+"】",title:a.title,img:a.img}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,str:getresult(a.result),find:plugfns(a.plugin).pagefind,successfn:function(b){b?plugfns(a.plugin).pagedeal(b):addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>没有内容</div>',
1)}}},countloader:function(a){return!1},countfinder:function(a){return{successfn:function(){mySession.nowlistpages="0|"+a.keyword+"|list";mySession.nowlistpage=1;console.log(mySession.nowlistpages);return!0}}}},searchflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"search?page="+(a.page||1)+"&ajax=1&order=1&key="+a.keyword+"&act=search",method:"GET",timeout:120,successfn:function(b,c){b?(ExView.workers.search.countfinder(obj_contact(a,{result:b,header:c})),a.successfn&&a.successfn({result:b,
header:c})):a.multsearch?a.multsearch():(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("【"+a.keyword+"】<br>获取搜索结果失败！","ExView"))},showinfo:{text:"正在搜索..."+(1<a.page?"<br>第"+a.page+"页":""),name:"【"+a.keyword+"】",title:"搜索"}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,str:getresult(a.result),find:plugfns(a.plugin).pagefind,successfn:function(b,c,e){console.log(b);
b?plugfns(a.plugin).pagedeal(b,a):a.multsearch?a.multsearch():addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>没有内容</div>',1)}}},countloader:function(a){return!1},countfinder:function(a){return{successfn:function(b){mySession.nowlistpages="0|"+a.keyword+"|search";mySession.nowlistpage=1;console.log(mySession.nowlistpages)}}}},contentflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"mh/"+a.pid+"/",method:"GET",timeout:120,successfn:function(b,
c){b?a.successfn&&a.successfn({result:b,header:c}):a.checkupdate||(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("内容页获取失败！","ExView"))},showinfo:{text:"正在加载内容页...",title:"内容页",name:getlistname(a.pid),img:getlistimg(a.pid)}}},finder:function(a){var b=getstr(/<h1>((?!<).*?)<\/h1>/,a.result);return{reg:/<li><a\s*href\=\"(?!\").*?\/mh\/\d+\/(\d+)\.html\"\s*title="((?!\").*?)"/g,str:getresult(a.result),
find:{pid:a.pid,cid:"$1",title:"$2"},successfn:function(c,e,f,d){console.log(typeof c);if(array_count(c)){if(a.checkupdate)return{pid:c.pid,cid:(c.cid||"").replace(/\//g,"_"),title:(c.title||"").replace(b,"")};for(f=0;f<d.length;f++)c=d[f],d[f]=additemlist({id:d.length-f-1,newest:a.newest&&0==f,pid:c.pid,cid:(c.cid||"").replace(/\//g,"_"),title:(c.title||"").replace(b,""),count:d.length,reverse:1});return d}a.checkupdate||(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("内容页获取失败！",
"ExView"))},afterfn:function(){a.checkupdate||ExView.workers.content.infofinder(a)}}},infoloader:function(a){return!1},infofinder:function(a){console.log(a);return{reg:/<div\s*class="main-bar\s*bar-bg1">((?:.|[\r\n])*?)<div\s*class="more"/g,str:a.result,find:"$1",successfn:function(b,c,e,f){console.log(JSON.stringify(b));c=getstr(/<img\s*src="((?!\").*?)"/,b);e=getstr(/<h1>((?!<).*?)<\/h1>/,b);f=getstr(/<i>((?!<).*?)<\/i>/,b);var d=getstr(/<dt>更新至：<\/dt>\s*\r*\n*\s*<dd>((?!<).*?)<\/dd>/,
b).replace(e,""),l=getstr(/<dt>更新于：<\/dt>\s*\r*\n*\s*<dd>((?!<).*?)<\/dd>/,b),h=getstr(/<dt>作者：<\/dt>\s*\r*\n*\s*<dd>((?!<).*?)<\/dd>/,b),k=getstr(/<dt>类别：<\/dt>\s*\r*\n*\s*<dd>((?!<).*?)<\/dd>/,b);b=getstr(/id="bookIntro">((?:.|[\r\n])*?)<\/div>/,b).replace(/style=/g,"xstyle=");var g=gettag(k);setlistpic({name:e,img:c,added:a.data,description:"<p>【作者】"+h+"<br>【类型】"+k+"<br>【"+f+"】"+l+"<br>【最新话】"+
d+"<br>【简介】"+b+"</p>",comment:1,preview:0,tags:gettag(e)+g+gettag(h),sourceurl:pluginfo(a.plugin).apihost+"mm/"+a.pid+".html"});return!0}}}},parseflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"mh/"+a.pid+"/"+a.cid+".html",method:"GET",timeout:120,successfn:function(b,c){a.successfn&&a.successfn({result:b,header:c})},showinfo:{text:"正在加载图片信息...",title:"图片",name:getlistname(a.pid),img:getlistimg(a.pid)}}},finder:function(a){console.log(a);
return{reg:/\$\.parseJSON\('\[(.*?)\]'\)/g,str:a.result,find:"$1",successfn:function(b){b?(b=eval("(["+b+"])"),console.log(b),a.download?chapterpredownload({source:b,download:a.download,plugin:a.plugin}):chapterviewer({source:b,type:"image",startindex:a.startindex||0,lazyload:pluginfo(a.plugin).lazyload,zoom:!0,title:a.title})):a.download?chapterpredownload({error:"解析错误！",download:a.download,plugin:a.plugin}):(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("图片信息获取失败！",
"ExView"));return!0}}}},commentflag:{loader:function(a){return{url:1==parseInt(a.page||1)?"http://changyan.sohu.com/api/2/topic/load?client_id=cysvo4t9u&topic_url="+encodeURIComponent(pluginfo(a.plugin).apihost+"mh/"+a.pid+"/")+"&page_size=30&hot_size=0&topic_source_id="+a.pid.substring(2):"http://changyan.sohu.com/api/2/topic/comments?client_id=cysvo4t9u&page_size=30&topic_id="+a.sid+"&page_no="+(a.page+1),method:"GET",timeout:120,successfn:function(b,c){if(b){var e={};1==parseInt(a.page||1)&&(e=
JSON.parse(b));a.callback&&a.callback({result:b,header:c,sid:e.topic_id||a.sid,commentbrowser:{url:pluginfo(a.plugin).apihost+"mh/"+a.pid+"/",title:"评论 - "+pluginfo(a.plugin).name+'<br><span style="font-size:16px">'+(myContent.name||"")+"</span>",browser:!1,flag:""}})}else a.callback&&a.callback()}}},finder:function(a){console.log(a);return{json:!0,str:a.result,successfn:function(b,c,e,f){if(array_count(b)){c=b.comments;b=b.total_page_no;for(var d in c)a.callback&&a.callback({page:a.page||
1,pagecount:b,comment:{text:c[d].content,name:c[d].passport.nickname,avatar:c[d].passport.img_url,type:"received",label:(new Date(parseInt(c[d].create_time))).toLocaleString().replace(/:\d{1,2}$/," "),day:"",time:"",reverse:1,extra:""}})}}}},send:!1},previewflag:{loader:!1,finder:!1,more:!1},pageimgflag:{parser:!1},updateflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"act/?act=list&page="+parseInt(a.page||1)+"&catid=0&ajax=1&order=1",method:"GET",timeout:120,successfn:function(b,c){a.successfn&&
a.successfn({result:b,header:c})}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,str:getresult(a.result),find:plugfns(a.plugin).pagefind,successfn:function(b){console.log(JSON.stringify(b));b&&plugfns(a.plugin).pagedeal(b,a)}}}},hotflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"act/?act=list&page="+parseInt(a.page||1)+"&catid=0&ajax=1&order=4",method:"GET",timeout:120,successfn:function(b,c){a.successfn&&a.successfn({result:b,header:c})}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,
str:getresult(a.result),find:plugfns(a.plugin).pagefind,successfn:function(b){console.log(JSON.stringify(b));b&&plugfns(a.plugin).pagedeal(b,a)}}}}},fns:{pagerule:/<a\s*href="(?!").*?\/mh\/(\d+)\/"><div\s*class=\"thumb\"><img\s*data-src=\"(.*?)\"\s*\/><i>(.*?)<\/i><\/div><h3>(.*?)<\/h3><dl><dt>作　者：<\/dt><dd>(.*?)<\/dd><\/dl><dl><dt>类　别：<\/dt><dd>(.*?)<\/dd><\/dl><dl><dt>更新至：<\/dt><dd>(.*?)<\/dd><\/dl><dl><dt>更新于：<\/dt><dd>(.*?)<\/dd><\/dl><\/a>/g,
pagefind:"$1{{separator}}$2{{separator}}$3{{separator}}$4{{separator}}$5{{separator}}$6{{separator}}$7{{separator}}$8",pagedeal:function(a,b){b=b||{};a=a.split("{{separator}}");var c=a[0],e=a[1],f=a[2],d=a[3],l=a[4],h=a[5],k=a[7],g=a[6];if(b.multupdate)return b.multupdate(obj_contact(b,{pid:c,img:e,title:d,content:g})),!1;if(b.multhot)return b.multhot(obj_contact(b,{pid:c,img:e,title:d,content:g})),!1;if(b.multsearch)return b.multsearch(obj_contact(b,{pid:c,img:e,title:d,content:g})),!1;addcardlist({pid:c,
title:d,name:"【"+l+"】"+d+"【"+f+"】",img:e,content:"【"+h+"】更新至 "+g,stitle:k,comment:1,preview:0,extrabutton:""})}}});
