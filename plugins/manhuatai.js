ExView.Plugins({info:{name:"\u6f2b\u753b\u53f0",version:"2.2",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMbSURBVDhPARAD7/wA/9yN35lE2YYq9Llt///kue78QaTfLKftLqfcK6bPLqrOJabNJa/gKqjaZL7juv//APfCgMKIP9GJN8uaWPz/7IfE1iWQyBeW2UrC9FjM81rM7lfR9i626hqZzjGRuZvr/wD/4rbDn22zgkfewpLt//d0v9QTj8UXot08r9tOtdRUs9FKstkoqeIVltAul8SG5P8A9//y9fni8uXF///m6v//cLnMGJLBDpbKUcPoZcbmcsvrZcXtM6zjFZHHKI23jef/AH7K2IXEzd7//+3//+n//5zU4UiszkK540Ky10ev0kyq0Emq1UW140m231qvzKfy/wBTt9kwi6pMlrO58//c//+s6vliw+RTx/BPxvBVyPRbxPRaw/NUx/NTweZ60e+y/f8AXrffMo+6KI6/VLbjsv//Q5q1Io+4HprNFZjOE5bOG5bRF5DHGprJGpfDI429Zsf6AMD//2a54RqNxiKb0oPr/zOavSWezVrf/wuX0jC8+Wfr/w6QzDjA8lfb/xiNw0q38gDi//+49P8hkcMWlcxu2/8vnMMSlMgptfAOmtcWoN4wtPQQldAep90rsuIdk8VIuOgA7f//wvr/JJTEGJbQcNX/ULbcL6/gIKzhK7LpJ6zkJafhJarjJbDpJaveNKnUXcnvAN///7Py/xqOvxuUzZjs/2293kS02jaz3zSt2jew3zSz5jG47zO/+je68FXB5Zv9/wDc//+L0uYajsEtotiy/P92vdk6pcc2rdU+sd0+tOI6vesbo9UNlc8alMUtiKOg7PoA0P//aLXTGYi9QrLkwv//mub+RrLWJqHNN6/hX9v/WuL/HafWGJfKLJS7j87d3v//ALb9/0uewCWJunve/6/5/z6KoiOPtkXC8iml2xKRxgyUxg6VxSim1oXr/8r//9b//wCH4fwxiKY6jLK0///A//9BjKMumcNCvvItquAZmM0Yl8wZmM0in9Uzo9M/lLl3wOAAfN75VrDLb7jZw///0v//kt30Q67YL63gMq/lTcz/Xtn/P7z0OLXvPbLnTq7ee9L9WBPyXTTnqqoAAAAASUVORK5CYII=",
author:"Gentle",db:"manhuatai",apihost:"http://m.manhuatai.com/",pagetitle:["<br>","\u6536\u85cf","\u9996\u9875","\u7c7b\u578b","\u4e0b\u8f7d"],download:!0,lazyload:!0,setting:!0,cdn:""},set:function(a){},unset:function(a){},init:function(){ExView.workers.fav.listloader({callback:function(){ExView.workers.index.loader()}})},flags:{indexflag:{loader:function(a){a.front||a.page||addtypelist('<div align="center" class="list-block"><img src="img/logo.png"/><br>\u7c7b\u578b<br>\u6b63\u5728\u52a0\u8f7d...<div class="progress"></span></div>',
2);return{url:pluginfo(a.plugin).apihost,method:"GET",timeout:120,successfn:function(b,c){ExView.workers.index.countfinder(obj_contact(a,{result:b,header:c}));a.front||a.page||ExView.workers.type.finder({result:b,plugin:a.plugin});a.successfn&&a.successfn({result:b,header:c})},errorfn:function(){a.page||addtypelist('<div align="center" class="list-block"><a href="javascript:void(0);" onclick="ExView.workers.type.loader();"><img src="img/logo.png"/><br>\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01</a></div>',
2);ExView.fw.hidePreloader();mySession.isloading=0;ExView.fw.alert("\u7f51\u7edc\u9519\u8bef\uff01","ExView")},canclefn:function(){a.page||addtypelist('<div align="center" class="list-block"><a href="javascript:void(0);" onclick="ExView.workers.type.loader();"><img src="img/logo.png"/><br>\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01</a></div>',2)},showinfo:{text:"\u6b63\u5728\u52a0\u8f7d..."+(1<a.page?"<br>\u7b2c"+a.page+"\u9875":""),name:"\u9996\u9875",title:a.title,img:a.img}}},
finder:function(a){return{reg:/<li><a\s*title=""\s*href="\/(\w[-\w.+]*)\/"><div><span\s*class="a">(.*?)<\/span><span\s*class="fl"><\/span><\/div><img.*?data-url="(.*?)"\s*title="(.*?)"><span\s*class="title">(.*?)<\/span>.*?<\/a><\/li>/g,str:a.result,find:{pid:"$1",img:"$3",title:"$5",content:"$2"},successfn:function(a){console.log(JSON.stringify(a));array_count(a)?addcardlist({pid:a.pid,title:a.title,img:a.img,content:a.content,comment:1}):addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>\u6ca1\u6709\u5185\u5bb9</div>',
2)}}},countloader:function(a){return!1},countfinder:function(a){return{successfn:function(){mySession.nowlistpages="-1|\u9996\u9875|index";mySession.nowlistpage=1;console.log(mySession.nowlistpages);return!0}}}},typeflag:{loader:function(a){return{successfn:function(){ExView.workers.index.loader()}}},finder:function(a){addtypelist({title:"\u9996\u9875",img:pluginfo(a.plugin).icon,group:{name:"daohang",title:"\u5bfc\u822a"},content:"\u9996\u9875"});addtypelist({tid:"all",title:"\u5168\u90e8",img:pluginfo(a.plugin).icon,
group:{name:"daohang",title:"\u5bfc\u822a"},content:"\u5168\u90e8"});return{reg:/<li\s*class="onehead"><span><a\s*href="\/(\w[-\w.+]*)\.html">(.*?)<i><\/i><\/a><\/span><\/li>/g,str:a.result,find:"$1{{separator}}$2",successfn:function(b){b=b.split("{{separator}}");array_count(b)?addtypelist({tid:b[0],title:b[1],img:pluginfo(a.plugin).icon,group:{name:"fenlei",title:"\u5206\u7c7b"},content:b[1]}):addtypelist('<div align="center" class="list-block"><a href="javascript:void(0);" onclick="ExView.workers.type.loader();"><img src="img/logo.png"/><br>\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01</a></div>',
2)}}}},listflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+a.keyword+(1<a.page?"_p"+a.page:"")+".html",method:"GET",timeout:120,successfn:function(b,c){b?(ExView.workers.list.countfinder(obj_contact(a,{result:b,header:c})),a.successfn&&a.successfn({result:b,header:c})):(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("\u3010"+a.title+"\u3011<br>\u83b7\u53d6\u5931\u8d25\uff01","ExView"))},showinfo:{text:"\u6b63\u5728\u52a0\u8f7d..."+(1<a.page?"<br>\u7b2c"+a.page+"\u9875":
""),title:a.title,name:"\u3010"+a.title+"\u3011",img:a.img}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,str:a.result,find:plugfns(a.plugin).pagefind,successfn:function(b){b?plugfns(a.plugin).pagedeal(b):addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>\u6ca1\u6709\u5185\u5bb9</div>',1)}}},countloader:function(a){return!1},countfinder:function(a){return{reg:/<\/a>\.\.\.\.\.<a\s*target="_self"\s*class="page"\s*href=".*?_p(\d+).html">/g,str:a.result,find:"$1",
successfn:function(b){mySession.nowlistpages=(b||"-1")+"|"+a.keyword+"|list";mySession.nowlistpage=1;console.log(mySession.nowlistpages);return!0}}}},searchflag:{loader:function(a){return 1<parseInt(a.page)?(a.multsearch&&a.multsearch(),!1):{url:pluginfo(a.plugin).apihost+"getjson.shtml?q="+encodeURIComponent(a.keyword),method:"GET",timeout:120,successfn:function(b,c){b?(a.multsearch||(ExView.workers.search.countfinder(obj_contact(a,{result:b,header:c})),setnowlistname("\u641c\u7d22\u3010"+a.keyword+
"\u3011")),a.successfn&&a.successfn({result:b,header:c})):a.multsearch?a.multsearch():(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("\u3010"+a.keyword+"\u3011<br>\u83b7\u53d6\u641c\u7d22\u7ed3\u679c\u5931\u8d25\uff01","ExView"))},showinfo:{text:"\u6b63\u5728\u641c\u7d22..."+(1<a.page?"<br>\u7b2c"+a.page+"\u9875":""),name:"\u3010"+a.keyword+"\u3011",title:"\u641c\u7d22"}}},finder:function(a){return{json:!0,str:a.result,successfn:function(b,c,e){console.log(b);if(array_count(b)){c=
b.cartoon_id;e=b.cartoon_name;var d=b.cartoon_status_id;b=b.latest_cartoon_topic_name;if(a.multsearch)return a.multsearch(obj_contact(a,{pid:c,img:"img/nopic.png",title:e,content:d})),!1;addcardlist({pid:c,title:e,name:"\u3010"+d+"\u3011"+e,img:"img/nopic.png",content:"",stitle:b,comment:1})}else a.multsearch?a.multsearch():addcardlist('<div align="center" class="list-block"><img src="img/logo.png"/><br>\u6ca1\u6709\u5185\u5bb9</div>',1)}}},countloader:function(a){return!1},countfinder:function(a){return{successfn:function(b){mySession.nowlistpages=
"-1|"+a.keyword+"|search";mySession.nowlistpage=1;console.log(mySession.nowlistpages)}}}},contentflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+a.pid+"/",method:"GET",timeout:120,successfn:function(b,c){b?a.successfn&&a.successfn({result:b,header:c}):a.checkupdate||(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("\u5185\u5bb9\u9875\u83b7\u53d6\u5931\u8d25\uff01","ExView"))},showinfo:{text:"\u6b63\u5728\u52a0\u8f7d\u5185\u5bb9\u9875...",title:"\u5185\u5bb9\u9875",name:getlistname(a.pid),
img:getlistimg(a.pid)}}},finder:function(a){var b=[],c=0;getstrs(a.result,/displayTab\('([\w,\d]+)','topicTab','topiccount','current'\);"><span>((?!<).*?)<\/span>/g,"$1|$2").forEach(function(d){var f=d.split("|");getstrs(a.result,new RegExp('<ul id="'+f[0]+'"(.*?)</ul>',"g"),"$1").forEach(function(a){a=getstrs(a,/<li><a\s*title="(.*?)"\s*href="([A-Za-z0-9][-A-Za-z0-9]*)\.html"><span>(.*?)<\/span><\/a><\/li>/g,"$1{{separator}}$2{{separator}}$3");b.push({group:{name:f[0],title:f[1]},items:a});c+=a.length})});
if(!c){var e=getstrs(a.result,/<li><a\s*title="(.*?)"\s*href="([A-Za-z0-9][-A-Za-z0-9]*)\.html"><span>(.*?)<\/span><\/a><\/li>/g,"$1{{separator}}$2{{separator}}$3");b.push({group:{},items:e});c+=e.length}return{successfn:function(d,f,e,h){console.log(typeof d);if(a.result){if(a.checkupdate){d=b[0];var k=d.group.title;d=(d||{}).items;d=(d||[])[0];d=(d||"").split("{{separator}}");return{pid:a.pid,cid:d[1],title:k+" "+d[2]}}myContent.mhkey=ExView.modules.commentpage.duoshuoloader(a.result);f=c;e=0;h=
[];b.forEach(function(b){var c;c=(b||{}).items;(c||[]).forEach(function(c){c=(c||"").split("{{separator}}");h[e]=additemlist({id:f-e-1,newest:a.newest&&0==e,pid:a.pid,cid:c[1],group:b.group,title:c[2],count:f,reverse:1});h[e].title=b.group.title+" "+c[2];e++})});return h}a.checkupdate||(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("\u5185\u5bb9\u9875\u83b7\u53d6\u5931\u8d25\uff01","ExView"))},afterfn:function(){a.checkupdate||ExView.workers.content.infofinder(a)}}},infoloader:function(a){return!1},
infofinder:function(a){console.log(a);return{reg:/<div\s*class="mhjsbody\s*clearfix"><img\s*src="(.*?)"\s*title=".*?"\s*class="fm"><div\s*class="jshtml"><ul><li>\u540d\u79f0\uff1a(.*?)<\/li><li>\u72b6\u6001\uff1a(.*?)<\/li><li>\u4f5c\u8005\uff1a(.*?)<\/li><li>\u7c7b\u578b\uff1a(.*?)<\/li><\/ul>.*?<div\s*class="wz\s*clearfix\s*t1"><div>((?:.|[\r\n])*?)<a\s*href="javascript:void/g,str:a.result,find:"$1{{separator}}$2{{separator}}$3{{separator}}$4{{separator}}$5{{separator}}$6",successfn:function(b,
c,e,d){b=b.split("{{separator}}");console.log(JSON.stringify(b));c=b[0];e=b[1];d=b[2].replace(/<\/a>/g,"").replace(/<a/g,"\x3c!--a").replace(/>/g,"--\x3e");var f=b[3],g=b[4];b=b[5].trim();var g=g.split(" "),g=g.map(function(a){return gettag(a)}),h=f.split(" "),h=h.map(function(a){return gettag(a)});setlistpic({name:e,img:c,added:a.data,description:"<p>\u3010\u4f5c\u8005\u3011"+f+"<br>\u3010\u72b6\u6001\u3011"+d+"<br>\u3010\u7b80\u4ecb\u3011"+b+"</p>",comment:1,preview:0,tags:gettag(e)+g.join("")+
h.join(""),sourceurl:pluginfo(a.plugin).apihost+a.pid+"/"});return!0}}}},parseflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+a.pid+"/"+a.cid+".html",method:"GET",timeout:120,successfn:function(b,c){a.successfn&&a.successfn({result:b,header:c})},showinfo:{text:"\u6b63\u5728\u52a0\u8f7d\u56fe\u7247\u4fe1\u606f...",title:"\u56fe\u7247",name:getlistname(a.pid),img:getlistimg(a.pid)}}},finder:function(a){console.log(a);return{reg:/var\s*mh_info={imgpath:"(.*?)",startimg:(\d+),totalimg:(\d+),mhid:"(\w[-\w.+]*)",mhname:"(.*?)",pageid:(\d+),pagename:"(.*?)",pageurl:"(.*?)",readmode:(\d+),maxpreload/g,
str:a.result,find:"$1{{separator}}$2{{separator}}$3{{separator}}$4{{separator}}$5{{separator}}$6{{separator}}$7{{separator}}$8{{separator}}$9",successfn:function(b){if(b){b=b.split("{{separator}}");for(var c=b[5].substr(b[5].length-1,1),e=[],d=b[0],f="",g=0;g<d.length;g++)code=d.substr(g,1).charCodeAt(),newchar=String.fromCharCode(code-c),f+=newchar;c=f.replace(/Z%/g,"%");b=parseInt(b[2]);for(d=0;d<b;d++)e.push("http://mhpic.taomanhua.com/comic/"+c+(d+1)+".jpg");console.log(e);a.download?chapterpredownload({source:e,
download:a.download,plugin:a.plugin}):chapterviewer({source:e,type:"image",startindex:a.startindex||0,lazyload:pluginfo(a.plugin).lazyload,zoom:!0,title:a.title})}else a.download?chapterpredownload({error:"\u89e3\u6790\u9519\u8bef\uff01",download:a.download,plugin:a.plugin}):(ExView.fw.hidePreloader(),mySession.isloading=0,ExView.fw.alert("\u56fe\u7247\u4fe1\u606f\u83b7\u53d6\u5931\u8d25\uff01","ExView"));return!0}}}},commentflag:{loader:function(a){myContent.mhkey||$$.ajax({url:pluginfo(a.plugin).apihost+
a.pid+"/",async:!1,success:function(a){myContent.mhkey=ExView.modules.commentpage.duoshuoloader(a)}});return{url:"http://manhuatai.duoshuo.com/api/threads/listPosts.json?thread_key="+myContent.mhkey+"&max_depth=1&page="+parseInt(a.page||1),method:"GET",timeout:120,successfn:function(b,c){b?a.callback&&a.callback({result:b,header:c,commentbrowser:{url:pluginfo(a.plugin).apihost+a.pid+"/",title:"\u8bc4\u8bba - "+pluginfo(a.plugin).name+'<br><span style="font-size:16px">'+(myContent.name||"")+"</span>",
browser:!1,flag:""}}):a.callback&&a.callback()}}},finder:function(a){console.log(a);return{json:!0,str:a.result,successfn:function(b,c,e,d){if(array_count(b)){c=b.cursor.pages;b=b.parentPosts;for(var f in b)a.callback&&a.callback({page:a.page||1,pagecount:c,comment:{text:b[f].message,name:b[f].author.name,avatar:b[f].author.avatar_url,type:"received",label:b[f].created_at.replace(/T/g," ").replace(/\+/g," "),day:"",time:"",reverse:1,extra:""}})}}}},send:!1},previewflag:{loader:!1,finder:!1,more:!1},
pageimgflag:{parser:!1},updateflag:{loader:function(a){return 1<a.page?(a.multupdate(),!1):{url:pluginfo(a.plugin).apihost,method:"GET",timeout:120,successfn:function(b,c){a.successfn&&a.successfn({result:b,header:c})}}},finder:function(a){return{reg:/<li><a\s*title=""\s*href="\/(\w[-\w.+]*)\/"><div><span\s*class="a">(.*?)<\/span><span\s*class="fl"><\/span><\/div><img.*?data-url="(.*?)"\s*title="(.*?)"><span\s*class="title">(.*?)<\/span>.*?<\/a><\/li>/g,str:a.result,find:{pid:"$1",img:"$3",title:"$5",
content:"$2"},successfn:function(b){console.log(JSON.stringify(b));if(array_count(b)&&a.multupdate)return a.multupdate(obj_contact(a,{pid:b.pid,img:b.img,title:b.title,content:b.content})),!1}}}},hotflag:{loader:function(a){return{url:pluginfo(a.plugin).apihost+"all"+(1<a.page?"_p"+a.page:"")+".html",method:"GET",timeout:120,successfn:function(b,c){a.successfn&&a.successfn({result:b,header:c})}}},finder:function(a){return{reg:plugfns(a.plugin).pagerule,str:a.result,find:plugfns(a.plugin).pagefind,
successfn:function(b){console.log(JSON.stringify(b));b&&plugfns(a.plugin).pagedeal(b,a)}}}}},fns:{pagerule:/<a\s*class="sdiv"\s*href="\/(\w[-\w.+]*)\/".*?><div\s*class="wrapleft"><div><span\s*class="a">(.*?)<\/span><span\s*class="fl"><\/span><\/div><img.*?data-url="(.*?)".*?><\/div><div\s*class="wrapright"><ul><li\s*class="title">(.*?)<\/li><li\s*class="type"><span>\u7c7b\u578b<\/span>(.*?)<\/li><li\s*class="status"><span>\u72b6\u6001<\/span>(.*?)<\/li><li><span>\u5267\u60c5<\/span>(.*?)<\/li><\/ul><\/div>\s*<\/a>/g,
pagefind:"$1{{separator}}$2{{separator}}$3{{separator}}$4{{separator}}$5{{separator}}$6{{separator}}$7",pagedeal:function(a,b){b=b||{};a=a.split("{{separator}}");var c=a[0],e=a[2],d=a[5],f=a[3],g=a[4],h=a[1],k=a[1];if(b.multhot)return b.multhot(obj_contact(b,{pid:c,img:e,title:f,content:h})),!1;addcardlist({pid:c,title:f,name:"\u3010"+g+"\u3011"+f+"\u3010"+d+"\u3011",img:e,content:a[6].trim(),stitle:k,comment:1,preview:0,extrabutton:""})}}});
