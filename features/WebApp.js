ExView.Plugins({info:{name:"\u8f7b\u5e94\u7528",version:"2.3",icon:getbaiduimg("20c8e3ef76094b36c7a8e53ba4cc7cd98c109d97"),db:"WebApp",type:"feature",fn:"ExView.modules.webapppage.init();"},set:function(){ExView.modules.webapppage={load:function(a){ExView.tools.file.mkdir("ExView/WebApp",function(){ExView.tools.file.scandir("ExView/WebApp",function(d){for(var b=[],e=0;e<d.length;e++){var c=d[e],f=c.toURL()||c.fullPath;c.isFile&&-1!=f.split(".")[f.split(".").length-1].indexOf("ewp")&&(c=f.split("/")[f.split("/").length-
1],b.push(c.substring(0,c.lastIndexOf("."))))}if(!b.length)return $$("#webappviewpage").html('<div align="center" class="list-block"><img src="img/logo.png"/><br>\u6ca1\u6709\u5185\u5bb9</div>'),a&&a(),!1;$$("#webappviewpage").html('<div class="list-block" style="margin-top:0px"><ul></ul></div>');for(var g in b)(function(a,e){ExView.tools.file.getfile("ExView/WebApp/"+decodeURIComponent(a)+".ewp",null,function(a){a=JSON.parse(a);a.sicon=a.icon;a.icon=getcoverload(a.icon,{loadingimg:"img/logo.png",
errorimg:"img/logo.png"});$$("#webappviewpage").find("ul").append('<li class="swipeout"><a href="javascript:void(0);" data-name="'+a.name+'" data-url="'+a.url+'" data-icon="'+a.sicon+'" data-css="'+a.css+'" data-js="'+a.js+'" data-ua="'+(a.ua||"")+'" data-showtitlebar="'+(a.showtitlebar||"")+'" class="item-link webappopenbutton"><div class="item-content swipeout-content"><div class="item-media"><img onerror="imgerror(this,\'img/logo.png\');" lowsrc="img/logo.png" src="'+a.icon+'" data-error="0" data-src="'+
a.icon+'"></div><div class="item-inner"><div class="item-title">'+a.name+'</div><div class="item-after"></div></div></div></a><div class="swipeout-actions-right"><a href="javascript:void(0);" class="bg-blue webappeditbutton">\u7f16\u8f91</a><a href="javascript:void(0);" class="bg-red webappdeletebutton">\u5220\u9664</a></div></li>')})})(b[g],a);setTimeout(function(){a&&a()},100)})})},callback:function(){$$(".addwebappbutton").on("click",function(){ExView.fw.swipeoutClose(".swipeout-opened");ExView.modules.webapppage.edit()});
$$(".webappdeletebutton").on("click",function(){ExView.fw.swipeoutClose(".swipeout-opened");var a=$$(this).parents("li").find(".item-title").html();ExView.fw.confirm("\u662f\u5426\u8981\u5220\u9664\uff1f<br>"+a,function(){ExView.tools.file.rmfile("ExView/WebApp/"+a+".ewp",function(){ExView.fw.alert(a+"<br>\u5220\u9664\u6210\u529f\uff01","ExView");ExView.modules.webapppage.load(ExView.modules.webapppage.callback)},function(){ExView.fw.alert(a+"<br>\u5220\u9664\u5931\u8d25\uff01","ExView");ExView.modules.webapppage.load(ExView.modules.webapppage.callback)});
ExView.fw.swipeoutClose(".swipeout-opened")})})},edit:function(a){var d=a?"\u914d\u7f6e"+getnavundertitle(a.name):"\u6dfb\u52a0\u8f7b\u5e94\u7528",b='<div class="list-block" style="margin-top:0px"><form id="webapp-form"><ul>'+getinput("name","\u540d\u79f0")+getinput("url","\u7f51\u5740(http://xxx.xxx.xxx/xxx)")+getinput("icon","\u56fe\u6807(http://xxx.xxx.xxx/favicon.ico)")+getinput("ua","\u8bbe\u7f6eUA")+gettextarea("css","\u63d2\u5165CSS","height:100px")+gettextarea("js","\u63d2\u5165JS","height:100px")+
getcheckbox("showtitlebar","\u663e\u793a\u6807\u9898\u680f")+'<li class="align-top"><div class="item-content"><div class="item-inner"><div class="item-title floating-label">\u63d2\u5165CSS\u8bf4\u660e</div><pre style="overflow:auto">'+ExView.tools.base64.decode("LyoqKioqKkNTU+aPkuWFpeaooeW8jyoqKioqKi8NCi8v566A5Y2V5qih5byPICDnm7TmjqXmj5LlhaXku6PnoIENCi8v5paH5Lu25qih5byPICB7ImZpbGUiOiJodHRwOi8veHh4Lnh4eC54eHgveHh4LmNzcyJ9DQovL+agh+WHhuaooeW8jyAge2NvZGU6Iip7dGV4dDpjZW50ZXJ9In0NCi8qKioqKipDU1Pmj5LlhaXmqKHlvI8qKioqKiov")+
'</pre></div></div></li><li class="align-top"><div class="item-content"><div class="item-inner"><div class="item-title floating-label">\u63d2\u5165JS\u8bf4\u660e</div><pre style="overflow:auto">'+ExView.tools.base64.decode("LyoqKioqKkpT5o+S5YWl5qih5byPKioqKioqLw0KLy/pq5jnuqfmqKHlvI8gIG15V2ViQXBwPXt9DQovL+eugOWNleaooeW8jyAg55u05o6l5o+S5YWl5Luj56CBDQovL+aWh+S7tuaooeW8jyAgeyJmaWxlIjoiaHR0cDovL3h4eC54eHgueHh4L3h4eC5qcyJ9DQovL+agh+WHhuaooeW8jyAge2NvZGU6ImFsZXJ0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsifQ0KLyoqKioqKkpT5o+S5YWl5qih5byPKioqKioqLw0KLyoqKioqKumrmOe6p+aooeW8j+S6i+S7tioqKioqKi8NCi8vYWxlcnQobXlXZWJWaWV3RXZlbnQudHlwZSk7DQovL2FsZXJ0KG15V2ViVmlld0V2ZW50LnVybCk7DQovL215V2ViVmlldy5pbnNlcnRDU1Moe2NvZGU6ImJvZHl7fSJ9LCBmdW5jdGlvbigpIHt9KTsNCi8vbXlXZWJWaWV3Lmluc2VydENTUyh7ZmlsZToiaHR0cDovL3h4eC54eHgueHh4L3h4eC5jc3MifSwgZnVuY3Rpb24oKSB7fSk7DQovL215V2ViVmlldy5leGVjdXRlU2NyaXB0KHtjb2RlOiJhbGVydCh3aW5kb3cubG9jYXRpb24uaHJlZik7In0sIGZ1bmN0aW9uKCkge30pOw0KLy9teVdlYlZpZXcuZXhlY3V0ZVNjcmlwdCh7ZmlsZToiaHR0cDovL3h4eC54eHgueHh4L3h4eC5qcyJ9LCBmdW5jdGlvbigpIHt9KTsNCi8qKioqKirpq5jnuqfmqKHlvI/kuovku7YqKioqKiovCQ==")+
"</pre></div></div></li></ul></from></div>";ExView.modules.createContentPage(d,b,"webappeditpage",'<a href="javascript:void(0);" class="link back savewebappbutton icon-only">\u4fdd\u5b58</a>',function(){a||(a={url:"http://www.bilibili.com/mobile/index.html",name:"\u54d4\u54e9\u54d4\u54e9",icon:"http://static.hdslb.com/mobile/img/512.png",css:"ZGl2LmItYXBwLWRsLXdycHt6LWluZGV4Oi0xIWltcG9ydGFudH0=",js:sessionStorage.webappdefaultjscode});a.css=ExView.tools.base64.decode(a.css)||"";a.js=ExView.tools.base64.decode(a.js)||
"";ExView.fw.formFromJSON($$("#webapp-form"),a);$$(".item-title.floating-label").parent().addClass("not-empty-state");$$(".savewebappbutton").on("click",function(){var a=ExView.fw.formToJSON($$("#webapp-form"));a.css=ExView.tools.base64.encode(a.css)||"";a.js=ExView.tools.base64.encode(a.js)||"";if(!a.name||!a.url)return ExView.fw.alert("\u8bf7\u586b\u5199\u8f7b\u5e94\u7528\u540d\u79f0\u548c\u8def\u5f84\uff01","ExView"),!1;ExView.tools.file.mkdir("ExView/WebApp/",function(){ExView.tools.file.savefile("ExView/WebApp/"+
a.name+".ewp",JSON.stringify(a),{file_append:!1,filemime:"text/json",filetype:"text"},function(){ExView.fw.alert(a.name+" \u5df2\u6dfb\u52a0\uff01","ExView");ExView.modules.webapppage.load(ExView.modules.webapppage.callback)},function(){ExView.fw.alert(a.name+" \u6dfb\u52a0\u5931\u8d25\uff01","ExView");ExView.modules.webapppage.load(ExView.modules.webapppage.callback)})},function(){ExView.fw.alert(a.name+" \u6dfb\u52a0\u5931\u8d25\uff01","ExView");ExView.modules.webapppage.load(ExView.modules.webapppage.callback)});
$$(".page[data-page='webappeditpage']").find(".dynamic-page-close").trigger("click")})},null,null,"")},init:function(){ExView.modules.createContentPage("\u8f7b\u5e94\u7528","","webappviewpage",'<a href="#" class="link addwebappbutton icon-only"><i class="icon icon-plus"></i></a>',function(){ExView.modules.webapppage.load(ExView.modules.webapppage.callback)},null,null,"")}}}});
